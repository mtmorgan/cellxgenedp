<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cellxgenedp">
<title>Case studies • cellxgenedp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case studies">
<meta property="og:description" content="cellxgenedp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cellxgenedp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_using_cellxgenedp.html">Discovery and retrieval</a>
    <a class="dropdown-item" href="../articles/b_case_studies.html">Case studies</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mtmorgan/cellxgenedp/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Case studies</h1>
                        <h4 data-toc-skip class="author">Martin
Morgan</h4>
            <address class="author_afil">
      Roswell Park Comprehensive Cancer
Center<br><a class="author_email" href="mailto:#"></a><a href="mailto:Martin.Morgan@RoswellPark.org" class="email">Martin.Morgan@RoswellPark.org</a>
      </address>
                  
      
      <small class="dont-index">Source: <a href="https://github.com/mtmorgan/cellxgenedp/blob/HEAD/vignettes/b_case_studies.Rmd" class="external-link"><code>vignettes/b_case_studies.Rmd</code></a></small>
      <div class="d-none name"><code>b_case_studies.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This article summarizes short case studies and solutions
      arising from user queries.</p>
    </div>
    
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>For each case study, ensure that cellxgenedp (see the <a href="https://bioconductor.org/packages/cellxgenedp" class="external-link">Bioconductor</a>
package landing page, or <a href="https://mtmorgan.github.io/cellxgenedp">GitHub.io</a> site) is
installed (additional installation options are at <a href="https://mtmorgan.github.io/cellxgenedp/" class="uri">https://mtmorgan.github.io/cellxgenedp/</a>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"BiocManager"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, repos <span class="op">=</span> <span class="st">"https://CRAN.R-project.org"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"cellxgenedp"</span><span class="op">)</span></span></code></pre></div>
<p>Load the package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mtmorgan.github.io/cellxgenedp/">cellxgenedp</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="case-study-authors-datasets">Case study: authors &amp; datasets<a class="anchor" aria-label="anchor" href="#case-study-authors-datasets"></a>
</h2>
<div class="section level3">
<h3 id="challenge-and-solution">Challenge and solution<a class="anchor" aria-label="anchor" href="#challenge-and-solution"></a>
</h3>
<p>This case study arose from a question on the CZI Science Community
Slack. A user asked</p>
<blockquote>
<p>Hi! Is it possible to search CELLxGENE and identify all datasets by a
specific author or set of authors?</p>
</blockquote>
<p>Unfortunately, this is not possible from the <a href="https://cellxgene.cziscience.com/" class="external-link">CELLxGENE</a> web site –
authors are only associated with collections, and collections can only
be sorted or filtered by title (or publication / tissue / disease /
organism).</p>
<p>A <a href="https://mtmorgan.github.io/cellxgenedp">cellxgenedp</a>
solution uses <code><a href="../reference/query.html">authors()</a></code> to discover authors and their
collections, and joins this information to <code><a href="../reference/query.html">datasets()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">author_datasets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/query.html">authors</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/query.html">datasets</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"collection_id"</span>,</span>
<span>    relationship <span class="op">=</span> <span class="st">"many-to-many"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">author_datasets</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 43,244 × 34</span></span></span>
<span><span class="co">#&gt;    collection_id  family given consortium dataset_id dataset_version_id donor_id</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> ceb895f4-ff9f… Zhu    Kaiyi <span style="color: #BB0000;">NA</span>         53ce2631-… 2f17c183-388a-4c0… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> ceb895f4-ff9f… Zhu    Kaiyi <span style="color: #BB0000;">NA</span>         1d4128f6-… 94762ee1-9f9f-49e… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> ceb895f4-ff9f… Bendl  Jaro… <span style="color: #BB0000;">NA</span>         53ce2631-… 2f17c183-388a-4c0… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> ceb895f4-ff9f… Bendl  Jaro… <span style="color: #BB0000;">NA</span>         1d4128f6-… 94762ee1-9f9f-49e… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ceb895f4-ff9f… Rahman Samir <span style="color: #BB0000;">NA</span>         53ce2631-… 2f17c183-388a-4c0… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> ceb895f4-ff9f… Rahman Samir <span style="color: #BB0000;">NA</span>         1d4128f6-… 94762ee1-9f9f-49e… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> ceb895f4-ff9f… Vicari Jame… <span style="color: #BB0000;">NA</span>         53ce2631-… 2f17c183-388a-4c0… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ceb895f4-ff9f… Vicari Jame… <span style="color: #BB0000;">NA</span>         1d4128f6-… 94762ee1-9f9f-49e… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ceb895f4-ff9f… Colem… Clai… <span style="color: #BB0000;">NA</span>         53ce2631-… 2f17c183-388a-4c0… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> ceb895f4-ff9f… Colem… Clai… <span style="color: #BB0000;">NA</span>         1d4128f6-… 94762ee1-9f9f-49e… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 43,234 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 27 more variables: assay &lt;list&gt;, batch_condition &lt;list&gt;, cell_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cell_type &lt;list&gt;, citation &lt;chr&gt;, development_stage &lt;list&gt;, disease &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   embeddings &lt;list&gt;, explorer_url &lt;chr&gt;, feature_biotype &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   feature_count &lt;int&gt;, feature_reference &lt;list&gt;, is_primary_data &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   mean_genes_per_cell &lt;dbl&gt;, organism &lt;list&gt;, primary_cell_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   raw_data_location &lt;chr&gt;, schema_version &lt;chr&gt;, …</span></span></span></code></pre></div>
<p><code>author_datasets</code> provides a convenient point from which
to make basic queries, e.g., finding the authors contributing the most
datasets.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">author_datasets</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">family</span>, <span class="va">given</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,988 × 3</span></span></span>
<span><span class="co">#&gt;    family      given        n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Casper      Tamara     232</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Dee         Nick       232</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Macosko     Evan Z.    230</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Chen        Fei        226</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Ding        Song-Lin   226</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Murray      Evan       226</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Hirschstein Daniel     217</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Travaglini  Kyle J.    202</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Nyhus       Julie      201</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Lein        Ed S.      198</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3,978 more rows</span></span></span></code></pre></div>
<p>Perhaps one is interested in the most prolific authors based on
‘collections’, rather than ‘datasets’. The five most prolific authors by
collection are</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prolific_authors</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/query.html">authors</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">family</span>, <span class="va">given</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">prolific_authors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;   family    given          n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Teichmann Sarah A.      23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Regev     Aviv          14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Haniffa   Muzlifah      12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Meyer     Kerstin B.    12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Polanski  Krzysztof     12</span></span></code></pre></div>
<p>The datasets associated with authors are</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span></span>
<span>    <span class="va">author_datasets</span>,</span>
<span>    <span class="va">prolific_authors</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span>, <span class="st">"given"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 376 × 35</span></span></span>
<span><span class="co">#&gt;    collection_id  family given consortium dataset_id dataset_version_id donor_id</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         d319af7f-… 3c80a5bb-8c89-433… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         bc7260e0-… cab44f51-3ebf-4c9… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         8623d55f-… f7e3732a-eea9-49a… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         7b75b2c4-… 4b53f264-a62e-41a… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         5cdbb2ea-… 9944528e-f23b-4d8… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         2f6a20f1-… 129c17aa-3d9d-435… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> f7cecffa-00b4… Meyer  Kers… <span style="color: #BB0000;">NA</span>         eaf0c852-… ec370e4c-4ce8-435… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> f7cecffa-00b4… Meyer  Kers… <span style="color: #BB0000;">NA</span>         5af90777-… 4fd0f389-89ac-4a6… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> f7cecffa-00b4… Meyer  Kers… <span style="color: #BB0000;">NA</span>         318cb2a6-… 99d31e0c-4ccf-42c… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> f7cecffa-00b4… Teich… Sara… <span style="color: #BB0000;">NA</span>         eaf0c852-… ec370e4c-4ce8-435… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 366 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 28 more variables: assay &lt;list&gt;, batch_condition &lt;list&gt;, cell_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cell_type &lt;list&gt;, citation &lt;chr&gt;, development_stage &lt;list&gt;, disease &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   embeddings &lt;list&gt;, explorer_url &lt;chr&gt;, feature_biotype &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   feature_count &lt;int&gt;, feature_reference &lt;list&gt;, is_primary_data &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   mean_genes_per_cell &lt;dbl&gt;, organism &lt;list&gt;, primary_cell_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   raw_data_location &lt;chr&gt;, schema_version &lt;chr&gt;, …</span></span></span></code></pre></div>
<p>Alternatively, one might be interested in specific authors. This is
most easily accomplished with a simple filter on
<code>author_datasets</code>, e.g.,</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">author_datasets</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>        <span class="va">family</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Teichmann"</span>, <span class="st">"Regev"</span>, <span class="st">"Haniffa"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 250 × 34</span></span></span>
<span><span class="co">#&gt;    collection_id  family given consortium dataset_id dataset_version_id donor_id</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         d319af7f-… 3c80a5bb-8c89-433… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         bc7260e0-… cab44f51-3ebf-4c9… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         8623d55f-… f7e3732a-eea9-49a… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         7b75b2c4-… 4b53f264-a62e-41a… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         5cdbb2ea-… 9944528e-f23b-4d8… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         2f6a20f1-… 129c17aa-3d9d-435… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> f7cecffa-00b4… Teich… Sara… <span style="color: #BB0000;">NA</span>         eaf0c852-… ec370e4c-4ce8-435… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> f7cecffa-00b4… Teich… Sara… <span style="color: #BB0000;">NA</span>         5af90777-… 4fd0f389-89ac-4a6… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> f7cecffa-00b4… Teich… Sara… <span style="color: #BB0000;">NA</span>         318cb2a6-… 99d31e0c-4ccf-42c… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2d2e2acd-dade… Teich… Sara… <span style="color: #BB0000;">NA</span>         f9846bb4-… f0b11a56-236f-4e7… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 240 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 27 more variables: assay &lt;list&gt;, batch_condition &lt;list&gt;, cell_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cell_type &lt;list&gt;, citation &lt;chr&gt;, development_stage &lt;list&gt;, disease &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   embeddings &lt;list&gt;, explorer_url &lt;chr&gt;, feature_biotype &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   feature_count &lt;int&gt;, feature_reference &lt;list&gt;, is_primary_data &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   mean_genes_per_cell &lt;dbl&gt;, organism &lt;list&gt;, primary_cell_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   raw_data_location &lt;chr&gt;, schema_version &lt;chr&gt;, …</span></span></span></code></pre></div>
<p>or more carefully by constructing at <code>data.frame</code> of
family and given names, and performing a join with
<code>author_datasets</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">authors_of_interest</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Teichmann"</span>, <span class="st">"Regev"</span>, <span class="st">"Haniffa"</span><span class="op">)</span>,</span>
<span>        given <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sarah A."</span>, <span class="st">"Aviv"</span>, <span class="st">"Muzlifah"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span></span>
<span>    <span class="va">author_datasets</span>,</span>
<span>    <span class="va">authors_of_interest</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"family"</span>, <span class="st">"given"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 240 × 34</span></span></span>
<span><span class="co">#&gt;    collection_id  family given consortium dataset_id dataset_version_id donor_id</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         d319af7f-… 3c80a5bb-8c89-433… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         bc7260e0-… cab44f51-3ebf-4c9… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         8623d55f-… f7e3732a-eea9-49a… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         7b75b2c4-… 4b53f264-a62e-41a… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         5cdbb2ea-… 9944528e-f23b-4d8… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1d1c7275-476a… Regev  Aviv  <span style="color: #BB0000;">NA</span>         2f6a20f1-… 129c17aa-3d9d-435… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> f7cecffa-00b4… Teich… Sara… <span style="color: #BB0000;">NA</span>         eaf0c852-… ec370e4c-4ce8-435… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> f7cecffa-00b4… Teich… Sara… <span style="color: #BB0000;">NA</span>         5af90777-… 4fd0f389-89ac-4a6… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> f7cecffa-00b4… Teich… Sara… <span style="color: #BB0000;">NA</span>         318cb2a6-… 99d31e0c-4ccf-42c… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2d2e2acd-dade… Teich… Sara… <span style="color: #BB0000;">NA</span>         f9846bb4-… f0b11a56-236f-4e7… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 230 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 27 more variables: assay &lt;list&gt;, batch_condition &lt;list&gt;, cell_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cell_type &lt;list&gt;, citation &lt;chr&gt;, development_stage &lt;list&gt;, disease &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   embeddings &lt;list&gt;, explorer_url &lt;chr&gt;, feature_biotype &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   feature_count &lt;int&gt;, feature_reference &lt;list&gt;, is_primary_data &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   mean_genes_per_cell &lt;dbl&gt;, organism &lt;list&gt;, primary_cell_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   raw_data_location &lt;chr&gt;, schema_version &lt;chr&gt;, …</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="areas-of-interest">Areas of interest<a class="anchor" aria-label="anchor" href="#areas-of-interest"></a>
</h3>
<p>There are several interesting questions that suggest themselves, and
several areas where some additional work is required.</p>
<p>It might be interesting to identify authors working on similar
disease, or other areas of interest. The <code>disease</code> column in
the <code>author_datasets</code> table is a list.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">author_datasets</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">family</span>, <span class="va">given</span>, <span class="va">dataset_id</span>, <span class="va">disease</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 43,244 × 4</span></span></span>
<span><span class="co">#&gt;    family  given    dataset_id                           disease   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Zhu     Kaiyi    53ce2631-3646-4172-bbd9-38b0a44d8214 <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Zhu     Kaiyi    1d4128f6-c27b-40c4-af77-b1c7e2b694e7 <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Bendl   Jaroslav 53ce2631-3646-4172-bbd9-38b0a44d8214 <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Bendl   Jaroslav 1d4128f6-c27b-40c4-af77-b1c7e2b694e7 <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Rahman  Samir    53ce2631-3646-4172-bbd9-38b0a44d8214 <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Rahman  Samir    1d4128f6-c27b-40c4-af77-b1c7e2b694e7 <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Vicari  James M. 53ce2631-3646-4172-bbd9-38b0a44d8214 <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Vicari  James M. 1d4128f6-c27b-40c4-af77-b1c7e2b694e7 <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Coleman Claire   53ce2631-3646-4172-bbd9-38b0a44d8214 <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Coleman Claire   1d4128f6-c27b-40c4-af77-b1c7e2b694e7 <span style="color: #949494;">&lt;list [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 43,234 more rows</span></span></span></code></pre></div>
<p>This is because a single dataset may involve more than one disease.
Furthermore, each entry in the list contains two elements, the
<code>label</code> and <code>ontology_term_id</code> of the disease.
There are two approaches to working with this data.</p>
<p>One approach to working with this data uses facilities in <a href="https://mtmorgan.github.io/cellxgenedp">cellxgenedp</a> as
outlined in an accompanying article. Discover possible diseases.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/facets.html">facets</a></span><span class="op">(</span><span class="fu"><a href="../reference/db.html">db</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"disease"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 103 × 4</span></span></span>
<span><span class="co">#&gt;    facet   label                                          ontology_term_id     n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> disease normal                                         PATO:0000461      <span style="text-decoration: underline;">1</span>001</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> disease COVID-19                                       MONDO:0100096       60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> disease dementia                                       MONDO:0001627       50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> disease diabetic kidney disease                        MONDO:0005016       26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> disease myocardial infarction                          MONDO:0005068       26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> disease autosomal dominant polycystic kidney disease   MONDO:0004691       24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> disease Alzheimer disease                              MONDO:0004975       15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> disease lung adenocarcinoma                            MONDO:0005061       11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> disease small cell lung carcinoma                      MONDO:0008433       11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> disease arrhythmogenic right ventricular cardiomyopat… MONDO:0016587        9</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 93 more rows</span></span></span></code></pre></div>
<p>Focus on <code>COVID-19</code>, and use <code><a href="../reference/facets.html">facets_filter()</a></code>
to select relevant author-dataset combinations.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">author_datasets</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/facets.html">facets_filter</a></span><span class="op">(</span><span class="va">disease</span>, <span class="st">"label"</span>, <span class="st">"COVID-19"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,766 × 34</span></span></span>
<span><span class="co">#&gt;    collection_id  family given consortium dataset_id dataset_version_id donor_id</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> a72afd53-ab92… Wilk   Aaro… <span style="color: #BB0000;">NA</span>         456e8b9b-… a5ac4378-58f6-4ff… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> a72afd53-ab92… Rusta… Arjun <span style="color: #BB0000;">NA</span>         456e8b9b-… a5ac4378-58f6-4ff… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> a72afd53-ab92… Zhao   Nanc… <span style="color: #BB0000;">NA</span>         456e8b9b-… a5ac4378-58f6-4ff… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> a72afd53-ab92… Roque  Jona… <span style="color: #BB0000;">NA</span>         456e8b9b-… a5ac4378-58f6-4ff… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> a72afd53-ab92… Martí… Giov… <span style="color: #BB0000;">NA</span>         456e8b9b-… a5ac4378-58f6-4ff… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> a72afd53-ab92… McKec… Juli… <span style="color: #BB0000;">NA</span>         456e8b9b-… a5ac4378-58f6-4ff… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> a72afd53-ab92… Ivison Geof… <span style="color: #BB0000;">NA</span>         456e8b9b-… a5ac4378-58f6-4ff… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> a72afd53-ab92… Ranga… Than… <span style="color: #BB0000;">NA</span>         456e8b9b-… a5ac4378-58f6-4ff… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> a72afd53-ab92… Verga… Rose… <span style="color: #BB0000;">NA</span>         456e8b9b-… a5ac4378-58f6-4ff… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> a72afd53-ab92… Hollis Tayl… <span style="color: #BB0000;">NA</span>         456e8b9b-… a5ac4378-58f6-4ff… <span style="color: #949494;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,756 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 27 more variables: assay &lt;list&gt;, batch_condition &lt;list&gt;, cell_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cell_type &lt;list&gt;, citation &lt;chr&gt;, development_stage &lt;list&gt;, disease &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   embeddings &lt;list&gt;, explorer_url &lt;chr&gt;, feature_biotype &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   feature_count &lt;int&gt;, feature_reference &lt;list&gt;, is_primary_data &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   mean_genes_per_cell &lt;dbl&gt;, organism &lt;list&gt;, primary_cell_count &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   raw_data_location &lt;chr&gt;, schema_version &lt;chr&gt;, …</span></span></span></code></pre></div>
<p>Authors contributing to these datasets are</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">author_datasets</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/facets.html">facets_filter</a></span><span class="op">(</span><span class="va">disease</span>, <span class="st">"label"</span>, <span class="st">"COVID-19"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">family</span>, <span class="va">given</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 794 × 3</span></span></span>
<span><span class="co">#&gt;    family       given           n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Farber       Donna L.       29</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Guo          Xinzheng V.    28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Saqi         Anjali         28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Baldwin      Matthew R.     27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Chait        Michael        27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Connors      Thomas J.      27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Davis-Porada Julia          27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Dogra        Pranay         27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Gray         Joshua I.      27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Idzikowski   Emma           27</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 784 more rows</span></span></span></code></pre></div>
<p>A second approach is to follow the practices in <a href="https://r4ds.hadley.nz/rectangling" class="external-link">R for Data Science</a>, the
<code>disease</code> column can be ‘unnested’ twice, the first time to
expand the <code>author_datasets</code> table for each disease, and the
second time to separate the two columns of each disease.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">author_dataset_diseases</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">author_datasets</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">family</span>, <span class="va">given</span>, <span class="va">dataset_id</span>, <span class="va">disease</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest_longer.html" class="external-link">unnest_longer</a></span><span class="op">(</span><span class="va">disease</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest_wider.html" class="external-link">unnest_wider</a></span><span class="op">(</span><span class="va">disease</span><span class="op">)</span></span>
<span><span class="va">author_dataset_diseases</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 57,097 × 5</span></span></span>
<span><span class="co">#&gt;    family  given    dataset_id                           label  ontology_term_id</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Zhu     Kaiyi    53ce2631-3646-4172-bbd9-38b0a44d8214 normal PATO:0000461    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Zhu     Kaiyi    1d4128f6-c27b-40c4-af77-b1c7e2b694e7 normal PATO:0000461    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Bendl   Jaroslav 53ce2631-3646-4172-bbd9-38b0a44d8214 normal PATO:0000461    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Bendl   Jaroslav 1d4128f6-c27b-40c4-af77-b1c7e2b694e7 normal PATO:0000461    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Rahman  Samir    53ce2631-3646-4172-bbd9-38b0a44d8214 normal PATO:0000461    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Rahman  Samir    1d4128f6-c27b-40c4-af77-b1c7e2b694e7 normal PATO:0000461    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Vicari  James M. 53ce2631-3646-4172-bbd9-38b0a44d8214 normal PATO:0000461    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Vicari  James M. 1d4128f6-c27b-40c4-af77-b1c7e2b694e7 normal PATO:0000461    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Coleman Claire   53ce2631-3646-4172-bbd9-38b0a44d8214 normal PATO:0000461    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Coleman Claire   1d4128f6-c27b-40c4-af77-b1c7e2b694e7 normal PATO:0000461    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 57,087 more rows</span></span></span></code></pre></div>
<p>Author-dataset combinations associated with COVID-19, and
contributors to these datasets, are</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">author_dataset_diseases</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">label</span> <span class="op">==</span> <span class="st">"COVID-19"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">author_dataset_diseases</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">label</span> <span class="op">==</span> <span class="st">"COVID-19"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">family</span>, <span class="va">given</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>These computations are the same as the earlier iteration using
functionality in <a href="https://mtmorgan.github.io/cellxgenedp">cellxgenedp</a>.</p>
<p>A further resource that might be of interest is the [OSLr][] package
article illustrating how the ontologies used by CELLxGENE can be
manipulated to, e.g., identify studies with terms that derive from a
common term (e.g., all disease terms related to ‘carcinoma’).</p>
</div>
<div class="section level3">
<h3 id="collaboration">Collaboration<a class="anchor" aria-label="anchor" href="#collaboration"></a>
</h3>
<p>TODO.</p>
<p>It might be interesting to know which authors have collaborated with
one another. This can be computed from the <code>author_datasets</code>
table, following approaches developed in the <a href="https://mtmorgan.github.io/grant" class="external-link">grantpubcite</a> package to
identify collaborations between projects in the NIH-funded ITCR program.
See the graph visualization in the <a href="https://mtmorgan.github.io/grantpubcite/articles/case_study_itcr.html#itcr-collaboration" class="external-link">ITCR
collaboration</a> section for inspiration.</p>
</div>
<div class="section level3">
<h3 id="duplicate-collection-author-combinations">Duplicate collection-author combinations<a class="anchor" aria-label="anchor" href="#duplicate-collection-author-combinations"></a>
</h3>
<p>Here are the authors</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">authors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/query.html">authors</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">authors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,154 × 4</span></span></span>
<span><span class="co">#&gt;    collection_id                        family   given      consortium</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> ceb895f4-ff9f-403a-b7c3-187a9657ac2c Zhu      Kaiyi      <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> ceb895f4-ff9f-403a-b7c3-187a9657ac2c Bendl    Jaroslav   <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> ceb895f4-ff9f-403a-b7c3-187a9657ac2c Rahman   Samir      <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> ceb895f4-ff9f-403a-b7c3-187a9657ac2c Vicari   James M.   <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ceb895f4-ff9f-403a-b7c3-187a9657ac2c Coleman  Claire     <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> ceb895f4-ff9f-403a-b7c3-187a9657ac2c Clarence Tereza     <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> ceb895f4-ff9f-403a-b7c3-187a9657ac2c Latouche Ovaun      <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ceb895f4-ff9f-403a-b7c3-187a9657ac2c Tsankova Nadejda M. <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ceb895f4-ff9f-403a-b7c3-187a9657ac2c Li       Aiqun      <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> ceb895f4-ff9f-403a-b7c3-187a9657ac2c Brennand Kristen J. <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,144 more rows</span></span></span></code></pre></div>
<p>There are 5154 collection-author combinations. We expect these to be
distinct (each row identifying a unique collection-author combination).
But this is not true</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">authors</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">authors</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>Duplicated data are</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">authors</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">collection_id</span>, <span class="va">family</span>, <span class="va">given</span>, <span class="va">consortium</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 73 × 5</span></span></span>
<span><span class="co">#&gt;    collection_id                        family     given        consortium     n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> e5f58829-1a66-40b5-a624-9046778e74f5 Pisco      Angela Oliv… <span style="color: #BB0000;">NA</span>             4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> e5f58829-1a66-40b5-a624-9046778e74f5 Crasta     Sheela       <span style="color: #BB0000;">NA</span>             3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> e5f58829-1a66-40b5-a624-9046778e74f5 Swift      Michael      <span style="color: #BB0000;">NA</span>             3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> e5f58829-1a66-40b5-a624-9046778e74f5 Travaglini Kyle J.      <span style="color: #BB0000;">NA</span>             3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> e5f58829-1a66-40b5-a624-9046778e74f5 de Morree  Antoine      <span style="color: #BB0000;">NA</span>             3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 51544e44-293b-4c2b-8c26-560678423380 Betts      Michael R.   <span style="color: #BB0000;">NA</span>             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 51544e44-293b-4c2b-8c26-560678423380 Faryabi    Robert B.    <span style="color: #BB0000;">NA</span>             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 51544e44-293b-4c2b-8c26-560678423380 Fasolino   Maria        <span style="color: #BB0000;">NA</span>             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 51544e44-293b-4c2b-8c26-560678423380 Feldman    Michael      <span style="color: #BB0000;">NA</span>             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 51544e44-293b-4c2b-8c26-560678423380 Goldman    Naomi        <span style="color: #BB0000;">NA</span>             2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 63 more rows</span></span></span></code></pre></div>
<p>Discover details of the first duplicated collection,
<code>e5f58829-1a66-40b5-a624-9046778e74f5</code></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">duplicate_authors</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/query.html">collections</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">collection_id</span> <span class="op">==</span> <span class="st">"e5f58829-1a66-40b5-a624-9046778e74f5"</span><span class="op">)</span></span>
<span><span class="va">duplicate_authors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 18</span></span></span>
<span><span class="co">#&gt;   collection_id     collection_version_id collection_url consortia contact_email</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> e5f58829-1a66-40… 0a47227f-aab6-4c3d-b… https://cellx… <span style="color: #949494;">&lt;list&gt;</span>    angela.pisco…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13 more variables: contact_name &lt;chr&gt;, curator_name &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   description &lt;chr&gt;, doi &lt;chr&gt;, links &lt;list&gt;, name &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   publisher_metadata &lt;list&gt;, revising_in &lt;lgl&gt;, revision_of &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   visibility &lt;chr&gt;, created_at &lt;date&gt;, published_at &lt;date&gt;, revised_at &lt;date&gt;</span></span></span></code></pre></div>
<p>The author information comes from the <code>publisher_metadata</code>
column</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">publisher_metadata</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">duplicate_authors</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">publisher_metadata</span><span class="op">)</span></span></code></pre></div>
<p>This is a ‘list-of-lists’, with relevant information as elements in
the first list</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">publisher_metadata</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "authors"         "is_preprint"     "journal"         "published_at"   </span></span>
<span><span class="co">#&gt; [5] "published_day"   "published_month" "published_year"</span></span></code></pre></div>
<p>and relevant information in the <code>authors</code> field, of which
there are 221</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">publisher_metadata</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"authors"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 221</span></span></code></pre></div>
<p>Inspection shows that there are four authors with family name
<code>Pisco</code> and given name <code>Angela Oliveira</code>: it
appears that the data provided by CZI indeed includes duplicate author
names.</p>
<p>From a pragmatic perspective, it might make sense to remove duplicate
entries from <code>authors</code> before down-stream analysis.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deduplicated_authors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">authors</span><span class="op">)</span></span></code></pre></div>
<p>Tools that I have found useful when working with list-of-lists style
data rare <a href="https://CRAN.r-project.org/package=listviewer" class="external-link">listviewer::jsonedit()</a>
for visualization, and <a href="https://CRAN.r-project.org/package=rjsoncons" class="external-link">rjsoncons</a> for
filtering and querying these data using JSONpointer, JSONpath, or
JMESpath expression (a more R-centric tool is the <a href="https://CRAN.r-project.org/package=purrr" class="external-link">purrr</a> package).</p>
<div class="section level4">
<h4 id="what-is-an-author">What is an ‘author’?<a class="anchor" aria-label="anchor" href="#what-is-an-author"></a>
</h4>
<p>The combination of family and given name may refer to two (or more)
different individuals (e.g., two individuals named ‘Martin Morgan’), or
a single individual may be recorded under two different names (e.g.,
given name sometimes ‘Martin’ and sometimes ‘Martin T.’). It is not
clear how this could be resolved; recording ORCID identifiers migth help
with disambiguation.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="case-study-using-ontology-to-identify-datasets">Case study: using ontology to identify datasets<a class="anchor" aria-label="anchor" href="#case-study-using-ontology-to-identify-datasets"></a>
</h2>
<p>This case study was developed in response to the following Slack
question:</p>
<blockquote>
<p>CELLxGENE’s webpage is using different ontologies and displaying them
in an easy to interogate manner (choosing amongst 3 possible coarseness
for cell types, tissues and age) I was wondering if this simplified tree
of the 3 subgroups for cell type, tissue and age categories was
available somewhere?</p>
</blockquote>
<p>As indicated in the question, CELLxGENE provides some access to
ontologies through a hand-curated three-tiered classification of
specific facets; the tiers can be retrieved from publicly available
code, but one might want to develop a more flexible or principled
approach.</p>
<p>CELLxGENE dataset facets like ‘disease’ and ‘cell type’ use terms
from ontologies. Ontologies arrange terms in directed acyclic graphs,
and use of ontologies can be useful to identify related datasets. For
instance, one might be interesed in cancer-related datasets (derived
from the ‘carcinoma’ term in the corresponding ontology) in general,
rather than, e.g., ‘B-cell non-Hodgkins lymphoma’.</p>
<p>In exploring this question in <em>R</em>, I found myself developing
the <a href="https://mtmorgan.github.io/OLSr" class="external-link">OLSr</a> package to query
and process ontologies from the EMBL-EBI <a href="https://www.ebi.ac.uk/ols4/" class="external-link">Ontology Lookup Service</a>. See the
‘<a href="https://mtmorgan.github.io/OLSr/articles/b_case_study_cxg.html" class="external-link">Case
Study: CELLxGENE Ontologies</a>’ article in the OLSr package for full
details.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<pre><code><span><span class="co">#&gt; R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] cellxgenedp_1.7.2 dplyr_1.1.4       BiocStyle_2.30.0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] tidyr_1.3.0         sass_0.4.8          utf8_1.2.4         </span></span>
<span><span class="co">#&gt;  [4] generics_0.1.3      stringi_1.8.3       digest_0.6.34      </span></span>
<span><span class="co">#&gt;  [7] magrittr_2.0.3      evaluate_0.23       bookdown_0.37      </span></span>
<span><span class="co">#&gt; [10] fastmap_1.1.1       jsonlite_1.8.8      promises_1.2.1     </span></span>
<span><span class="co">#&gt; [13] BiocManager_1.30.22 httr_1.4.7          purrr_1.0.2        </span></span>
<span><span class="co">#&gt; [16] fansi_1.0.6         textshaping_0.3.7   jquerylib_0.1.4    </span></span>
<span><span class="co">#&gt; [19] cli_3.6.2           shiny_1.8.0         rlang_1.1.3        </span></span>
<span><span class="co">#&gt; [22] ellipsis_0.3.2      withr_3.0.0         cachem_1.0.8       </span></span>
<span><span class="co">#&gt; [25] yaml_2.3.8          tools_4.3.2         memoise_2.0.1      </span></span>
<span><span class="co">#&gt; [28] httpuv_1.6.13       DT_0.31             curl_5.2.0         </span></span>
<span><span class="co">#&gt; [31] vctrs_0.6.5         rjsoncons_1.1.0     R6_2.5.1           </span></span>
<span><span class="co">#&gt; [34] mime_0.12           lifecycle_1.0.4     stringr_1.5.1      </span></span>
<span><span class="co">#&gt; [37] fs_1.6.3            htmlwidgets_1.6.4   ragg_1.2.7         </span></span>
<span><span class="co">#&gt; [40] pkgconfig_2.0.3     desc_1.4.3          pkgdown_2.0.7      </span></span>
<span><span class="co">#&gt; [43] pillar_1.9.0        bslib_0.6.1         later_1.3.2        </span></span>
<span><span class="co">#&gt; [46] glue_1.7.0          Rcpp_1.0.12         systemfonts_1.0.5  </span></span>
<span><span class="co">#&gt; [49] xfun_0.41           tibble_3.2.1        tidyselect_1.2.0   </span></span>
<span><span class="co">#&gt; [52] knitr_1.45          xtable_1.8-4        htmltools_0.5.7    </span></span>
<span><span class="co">#&gt; [55] rmarkdown_2.25      compiler_4.3.2</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Morgan, Kayla Interdonato.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
